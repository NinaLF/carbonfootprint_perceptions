---
title: "carbon footprint perceptions results pilot"

date: "`r Sys.Date()`"
output:
  html_document:
    theme: lumen
    toc: yes
    toc_depth: 4
    number_sections: no
    keep_md: yes

---


```{r setup, include=FALSE}
knitr::opts_chunk$set(class.source = "CSSoutput",
                      eval = TRUE, echo = FALSE, include = TRUE,warning=FALSE,
                      fig.align='center', fig.show='asis', fig.width = 16, fig.height = 10,
                      size='footnotesize')

```

```{r packages, include=FALSE}
getwd()

library(tidyverse)
library(sjPlot)
library(rcompanion)
library(rstatix)
library(lmerTest); library(lme4)
library(sjlabelled)
library(sjmisc)
library(emmeans)
library("rmcorr")
library(psych)
library(patchwork)
library(afex)
library(ClinSigMeasures)
library(prettydoc)
library(ggeffects)
library(reghelper) # for simple slopes
library(interactions)# for simple slopes

library("rmcorr")
library(Hmisc)
library(corrplot)
library(ggcorrplot)
library(ircor)

library(GPArotation)
set_theme(base=theme_classic())
# so plot_model plots look nice
set_theme(base=theme_classic())
```



```{r data, include=FALSE}
data <- read.csv("data/data.all_variables.csv")
data <- na.omit(data)

data$age.control <- 2023 - data$age_year
data$age.control2 <- 2022- data$age_year
data$age.control.f <- ifelse(between(data$age, data$age.control2, data$age.control ), "okay", "no")

data.excl <- data %>% select(age.control.f, participant.label) %>% filter(age.control.f=="no")

data.policies.long <- read.csv("data/data.policies.long.csv")
data.policies.long$support.f <- factor(data.policies.long$support.f)
data.policies.long$type <- factor(data.policies.long$type)
data.policies.long$policy2 <- factor(data.policies.long$policy,
                                    levels=c("subsidies alternative flying", "expand public transport", "subsidies RE projects", "subsidies low emission foods","subsidies regional food", "expand recycling",   
                                             "taxes air travel","ban diesel&petrol cars",  "electricity price peak times", "taxes red meat", "taxes imported food",   "taxes non-recylabes"))

data.policies.long <- data.policies.long[!c(data.policies.long$participant.label %in% data.excl$participant.label), ] 
data.policies.long$income <- factor(data.policies.long$income, levels=c("< 18.000£", "18.000£ to 23.000£", "23.001£ to 30.500£", "30.501£ to 45.000£", "> 45.001£"))

data.regression.weights <- read.csv("data/data.regression.weights.csv")
data.regression.weights <- data.regression.weights[!c(data.regression.weights$participant.label %in% data.excl$participant.label), ] 

data.regression.weights$income <- factor(data.regression.weights$income, levels=c("< 18.000£", "18.000£ to 23.000£", "23.001£ to 30.500£", "30.501£ to 45.000£", "> 45.001£"))
data.regression.weights$rel.cc.concern <- scale(data.regression.weights$cc_concern.mean)[,1]
## factors
data.regression.weights <- data.regression.weights %>%
  mutate_at(vars(starts_with("footprint")), list(fact = function(x){ factor(x )  })) %>% 
  mutate(across(ends_with("fact"), as.factor) )

data.regression.weights$footprint.diet_fact <- factor(data.regression.weights$footprint.diet_fact, levels=c(0.955, 1.053 ,1.234 ,1.431, 2.282,  3.16),
                                                      labels=c("vegan", "vegetarian", "no red meat", "pescetarian", "meat-based", "no pork") )
data.regression.weights$footprint.flying_fact <- factor(data.regression.weights$footprint.flying_fact, levels=c( 0  ,0.36,   0.9  ,2.07,  3.59,  6.74, 13.48 ),
                                                      labels=c("did not fly", "flew less than 2 hours", "flew less than 8 hours", "flew less than 15 hours", "flew less than 25 hours", "flew less than 50 hours", "flew more than 50 hours") )

data.regression.weights$footprint.electricity_fact <- factor(data.regression.weights$footprint.electricity_fact, levels=c( 0.1031, 0.6988837 , 1.294697  ),
                                                      labels=c("have a renwable electricity supply", "have a mixed electricity supply", "have a conventional supply / dont know") )

data.accuracy.score.tau <- read.csv("data/data.accuracy.score.tau.csv")
data.accuracy.score.tau <- data.accuracy.score.tau[!c(data.accuracy.score.tau$participant.label %in% data.excl$participant.label), ] 

data.accuracy.score.tau$income <- factor(data.accuracy.score.tau$income, levels=c("< 18.000£", "18.000£ to 23.000£", "23.001£ to 30.500£", "30.501£ to 45.000£", "> 45.001£"))
data.accuracy.score.tau$rel_cc_concern.mean.f <- factor(data.accuracy.score.tau$rel_cc_concern.mean.f)
data.accuracy.score.tau$rel_cor.tau.f <- factor(data.accuracy.score.tau$rel_cor.tau.f)

data.accuracy.score <- read.csv("data/data.accuracy.score.csv")
data.accuracy.score <- data.accuracy.score[!c(data.accuracy.score$participant.label %in% data.excl$participant.label), ] 


data.perceptions.total <- read.csv("data/data.perceptions.total.csv")
data.perceptions.total <- data.perceptions.total[!c(data.perceptions.total$participant.label %in% data.excl$participant.label), ] 
data.perceptions.total$income <- factor(data.perceptions.total$income, levels=c("< 18.000£", "18.000£ to 23.000£", "23.001£ to 30.500£", "30.501£ to 45.000£", "> 45.001£"))

data.perceptions.total$flying <- factor(data.perceptions.total$flying, 
                                        levels=c("takes train (does not fly)", "flies 2/year"))
data.perceptions.total$diet <- factor(data.perceptions.total$diet, 
                                        levels=c("vegetarian", "meat-based"))
data.perceptions.total$electricity <- factor(data.perceptions.total$electricity, 
                                     levels=c("100% renewable energy supply", "mixed energy supply"))
data.perceptions.total$commute <- factor(data.perceptions.total$commute, 
                                     levels=c("take the bike", "takes the bus"))
data.perceptions.total$regional <- factor(data.perceptions.total$regional, 
                                         levels=c("only regional", "regional and imported"))
data.perceptions.total$recycling <- factor(data.perceptions.total$recycling, 
                                          levels=c("recycles", "does not recycle"))

data.perceptions.total$rel.cc.concern <- scale(data.perceptions.total$cc_concern.mean)[,1]



```

```{r}
## same response pattern??

data.perceptions.test <- pivot_wider(data.perceptions.total, id_cols = "participant.label" ,names_from ="vignette", values_from= "rating")
                                     

data.perceptions.test$same <- apply(data.perceptions.test[,c(2:17)], 1, function(x) length(unique(x)) <= 3)
#table(data.perceptions.test$same )
## only 8 people use only 3 of the scale points from 1-10, excluding these people has virtually no impact on results
data.perceptions.excl <- data.perceptions.test %>% filter(same=="FALSE" ) %>% select(participant.label)

data.perceptions.total.excl <- merge(data.perceptions.total, data.perceptions.excl, by="participant.label")

### exclude those with negative impact perceptions (because that makes 0 sense)
data.regression.weights.excl  <- data.regression.weights %>% filter(!diet.weight<0) %>%
  filter(!flying.weight<0) %>%  filter(!electricity.weight<0) %>%
  filter(!recycling.weight<0) %>%  filter(!commute.weight<0) %>% filter(!regional.weight<0)

### exclude those with negative accuracy score assoication because they are so bad that there is a negative correlation..
data.accuracy.score.tau.excl <- data.accuracy.score.tau %>% filter(!cor.tau<0) 

```


## Overview and descriptives
```{r}
t.gender <- table(data$gender)
t.income <- table(data$income)
```

Sample:  
N=196, (excluded n=3 out of 199 because of inconsistent response (age and year of birth do not match +-1)).  
Age: Mean: `r round( mean(data$age),1) `, range: `r range(data$age)`.  
gender: female: `r t.gender[[1]] ` ; male: `r t.gender[[2]] `  
income: 
```{r}
knitr::kable(t.income, align = "l", col.names = c("income", "Frequency"))
```

  
  
### Climate change concern
```{r plot.ccc,   message=FALSE}

## cc concern

data.cc_concern <-data %>% select(participant.label, climate_change_concern1,climate_change_concern2,climate_change_concern3,climate_change_concern4, cc_concern.mean, conservative_liberal.binary)
data.cc_concern <- na.omit(data.cc_concern)
data.cc_concern.long <- pivot_longer(data.cc_concern, climate_change_concern1:climate_change_concern4, names_to = "item", values_to = "cc.concern")

data.cc_concern.long$cc.concern.f <- factor(data.cc_concern.long$cc.concern)
 
ggplot(data.cc_concern.long,aes( x=item, fill=cc.concern.f), group=item) +
  geom_bar( position="dodge") + facet_grid(conservative_liberal.binary ~.) +
  theme_minimal() +
  theme(axis.title  = element_text(size = 18), 
        axis.text.y = element_text(size = 18),
        axis.text.x = element_text(size=18, angle=90 ),
        strip.text = element_text(size=18))  +
  scale_fill_viridis_d()

tapply(data$cc_concern.mean, data$conservative_liberal.binary, mean)

```


### Policy support
Alpha= 0.87
```{r plot.policy,   message=FALSE}
## visualizing
data.policies.long2 <- data.policies.long %>% filter(!policy2=="expand recycling") %>% filter(!policy2=="taxes non-recylabes")
ggplot(data.policies.long2,aes( x=policy2, fill=support.f), group=type) +
  geom_bar( position="dodge") + 
  theme_minimal() +
  theme(axis.title  = element_text(size = 18), 
        axis.text.y = element_text(size = 18),
        axis.text.x = element_text(size=18, angle=90 ),
        strip.text = element_text(size=18))  +
  scale_fill_viridis_d()


## means
data.policy.means <- groupwiseMean(support ~ policy2 + conservative_liberal.binary,
                                   data=data.policies.long2)
# midpoint would be 4
ggplot(data.policy.means,aes( x=policy2, y=Mean, fill=policy2) )+
  geom_bar( position="dodge", stat="identity") + 
  facet_grid(conservative_liberal.binary ~.) +
  geom_errorbar(aes(ymin=Trad.lower, ymax=Trad.upper), position=position_dodge(0.9), width=0.1) +
  theme_minimal() +
  theme(axis.title  = element_text(size = 18), 
        axis.text.y = element_text(size = 18),
        axis.text.x = element_text(size=18, angle=90 ),
        strip.text = element_text(size=18))  +
  scale_fill_viridis_d() + ylim(0,7.5) + 
  geom_abline(slope=0, intercept=4,linetype="dashed" ) +
  labs(x="policies", y="Mean support", fill=NULL)

```

```{r, include=FALSE}

## basics, reliability etc
#psych::alpha(data[c("policy_item1" ,"policy_item11" ,  "policy_item3", "policy_item5" , "policy_item8", 
 #                            "policy_item12",  "policy_item2", "policy_item4" , "policy_item6",  "policy_item7" )])

# alpha = 0.87
#item 10 (expand recyling) , item9 taxes on non-recyclables
# "subscaling" subsidies = 0.79
#psych::alpha(data[c("policy_item1" ,"policy_item11" ,  "policy_item3", "policy_item5" , "policy_item8")])
# "subscaling" taxes = 0.89
#psych::alpha(data[c( "policy_item12",  "policy_item2", "policy_item4" , "policy_item6",  "policy_item7" )])

```

### Reported Behaviors 
Correlation between reported behaviors
```{r}
corr.behaviors <- data.regression.weights %>% select(footprint.diet, footprint.regional, footprint.electricity, footprint.recycling, 
                                                     footprint.travel.car, footprint.flying, footprint.public.transport)
coef.behaviors <- rcorr(as.matrix(corr.behaviors))
corrplot(coef.behaviors$r, type="upper", order="hclust", 
         p.mat = NULL, sig.level = 0.05, insig = "blank")


```

```{r}
## factors


corr.behaviors.fact <-data.regression.weights %>% select(ends_with("_fact")) %>% select(!footprint.public.transport_fact)

model.matrix(~0+., data=corr.behaviors.fact) %>% 
  cor(use="pairwise.complete.obs") %>% 
  ggcorrplot(show.diag=FALSE, type="lower", lab=TRUE, lab_size=2)

```

### Perceived impact

```{r}
data.regression.weights.long <-  pivot_longer(data.regression.weights,flying.weight:recycling.weight, names_to = "behavior", values_to = "regression.weight" )

data.regression.weights.long$behavior.label <- factor(data.regression.weights.long$behavior, 
                                                levels=c("flying.weight", "diet.weight", "electricity.weight" ,"regional.weight", "commute.weight","recycling.weight" ) ,
                                                labels=c("train vs. flying 2/year", "diet vegetarian vs. omnivore", "100% RE vs. mixed",
                                                         "regional only vs imported food", "commute by bus vs. bike", "recycling vs. not")) 

ggplot(data.regression.weights.long, aes(x=behavior.label, y=regression.weight, color=behavior.label)) +
  geom_boxplot() + 
  # facet_grid(conservative_liberal.binary~.) +
  theme_minimal() +
  theme(axis.title  = element_text(size = 18), 
        axis.text.y = element_text(size = 18),
        axis.text.x = element_text(size=18, angle=90 ),
        strip.text = element_text(size=18),
        legend.position = "none")  +
  scale_color_viridis_d() +
  labs(fill=NULL, x="behaviors in judgment task", y="perceived impact(regression weight)")
```
  
Quality check:  
Only 8 individuals show a reduced variance in their impact ratings, such that they  only use 3 or less of the scale points from 1-10. Excluding these people has virtually no impact on results.


### Description of typical participant
```{r}

data.behaviors.diet <- data.regression.weights %>% select(participant.label, footprint.diet_fact) %>% group_by(footprint.diet_fact) %>% tally()
data.behaviors.diet$perc <- round(data.behaviors.diet$n/199*100,1)


data.behaviors.flying <- data.regression.weights %>% select(participant.label, footprint.flying_fact) %>% group_by(footprint.flying_fact) %>% tally()
data.behaviors.flying$perc <- round(data.behaviors.flying$n/199*100,1)

data.behaviors.elec <- data.regression.weights %>% select(participant.label, footprint.electricity_fact) %>% group_by(footprint.electricity_fact) %>% tally()
data.behaviors.elec$perc <- round(data.behaviors.elec$n/199*100,1)

```
Most participants: `r paste0(data.behaviors.diet$perc[data.behaviors.diet$footprint.diet_fact=="meat-based" ] , "%") ` follow a meat-based diet, `r paste0(data.behaviors.flying$perc[data.behaviors.flying$footprint.flying_fact=="did not fly" ] , "%") ` did not fly , 
and have a conventional electricity supply (or dont know): `r paste0(data.behaviors.elec$perc[data.behaviors.elec$footprint.electricity_fact=="have a conventional supply / dont know" ] , "%" ) `, whereas `r paste0(data.behaviors.elec$perc[data.behaviors.elec$footprint.electricity_fact=="have a renwable electricity supply"], "%") ` have a renewable electricity supply, and only `r paste0(data.behaviors.diet$perc[data.behaviors.diet$footprint.diet_fact=="vegetarian" ] + data.behaviors.diet$perc[data.behaviors.diet$footprint.diet_fact=="vegan" ], "%" )` are vegan or vegetarian    
  
    
## Hypotheses
**Quick overview**  
  
  
H1: We assume that the impact of behaviors has an impact on participants’ estimations of the size of carbon footprints. We specifically expect that high impact behaviors have a stronger weight on impact estimations compared to low impact behaviors.  

+ **Yes**.  
+ Certain misperceptions on behavior level but this basically only recycling  

H1b: We expect that perceptions of the size of carbon footprints are influenced by interactions between behaviors. Specifically, we will investigate the interactions between: diet and regionality, diet and electricity supply, diet and flying, flying and commuting  

+ **Yes/No** , no compensatory beliefs identified except for diet x flying  

H2: We expect to find an association between the accuracy of carbon footprint estimations and individuals' climate change concern, political orientation, carbon footprints based on reported behavior, and policy support. Specifically, we expect that individuals with more accurate perceptions are more likely to have lower carbon footprints and report higher policy support.  
We moreover expect that individuals with higher levels of climate change concern have more accurate perceptions. Additionally, we will explore whether the association between accuracy and behavior or accuracy and policy support is moderated by climate change concern and political orientation  

+ **Yes**, Accuracy is predicted by climate change concern  
+ **Yes**, Policy is predicted by accuracy (more accuracy = more policy support).  
+ **No**, Carbon footprint not associated with accuracy (as long as controlling for income) - only for diet is it related: more accuracy=lower dietary carbon footprint (but this association is lost when excluding those with negative correlations).  
+ **No** moderation of accuracy and policy/behavior by cc concern.  

H3: We expect that the perceived impact of behaviors on the size of carbon footprints is influenced by self-reported climate relevant behavior. Specifically, we expect that individuals exhibit motivated reasoning such that the more a person engages in a given climate-unfriendly behavior, the lower they estimate the behavior to have an impact on the size of carbon footprints.   

+ **No**
+ As factors for diet highest level (=no pork versus vegan sign. Smaller impact perception).  

H4: We expect that climate policy support for specific consumer behaviors is influenced by the perceived impact of those behaviors on the size of carbon footprints. Specifically, we expect that individuals with higher (versus lower) impact perceptions of a behavior are more supportive of policies targeting that behavior. 

+ **Yes/No** ,for flying more impact perception associated with higher flying policy support - this only signficant when adjusting p-values when those with negative regression weights excluded
  
   
Info for H2, H3 and H4 I excluded individuals with negative regression weights (because they make no sense)    
  
## Hypothesis 1, 1a {.tabset}

*We will explore the accuracy of perceptions of the impact of different behaviors and domains on carbon footprints. Specifically, we expect that individuals will underestimate the effect of higher impact behavior (flying, diet, electricity supply) and underestimate the effect of relatively less impactful behaviors (recycling, public transport, imported foods) *
*We assume that the impact of behaviors and their domain has an impact on participants’ estimations of the size of carbon footprints. We specifically expect that high impact behaviors have a stronger weight on impact estimations compared to low impact behaviors. *

```{r}
data.perceptions.total.long <- data.perceptions.total
data.perceptions.total.long$diet <-(as.numeric(data.perceptions.total.long$diet)-1)
data.perceptions.total.long$flying <- (as.numeric(data.perceptions.total.long$flying)-1)
data.perceptions.total.long$commute <- (as.numeric(data.perceptions.total.long$commute)-1)
data.perceptions.total.long$regional <- (as.numeric(data.perceptions.total.long$regional)-1)
data.perceptions.total.long$recycling <- (as.numeric(data.perceptions.total.long$recycling)-1)
data.perceptions.total.long$electricity <- (as.numeric(data.perceptions.total.long$electricity)-1)

data.perceptions.total.long1 <- data.perceptions.total.long%>% rowwise() %>% 
    mutate(high.impact= sum(commute, regional, recycling),
           low.impact = sum(flying, diet,   electricity)  ,
           household = sum( electricity, recycling), 
           food =  sum( diet,   regional)  ,
           transport = sum(flying, commute)  )

model.perceptions.long.impact <- lmer(rating ~   high.impact+low.impact+  #household + food + transport +
                                   age + gender + income + education +

                            (1|participant.label) , #+ (1|vignette),
                          data=data.perceptions.total.long1)

data.perceptions.total.long1 <- data.perceptions.total.long%>% rowwise() %>% 
  mutate(high.impact= factor(sum(commute, regional, recycling), levels=c(0,1,2,3), labels=c("none", "1", "2", "all") )  ,
          low.impact = factor(sum(flying, diet,   electricity), levels=c(0,1,2,3), labels=c("none", "1", "2", "all") )  ,
         household = factor(sum( electricity, recycling), levels=c(0,1,2), labels=c("none", "1", "both") )   ,
         food =  factor(sum( diet,   regional), levels=c(0,1,2), labels=c("none", "1", "both") )   ,
         transport = factor(sum(flying, commute), levels=c(0,1,2), labels=c("none", "1", "both") )   )

model.perceptions.long.impact2 <- lmer(rating ~   high.impact + low.impact+  #household + food + transport +
                                   age + gender + income + education +

                            (1|participant.label) , #+ (1|vignette),
                          data=data.perceptions.total.long1)
```

### Effect of high versus low impact behaviors 
=>**The amount of low imoact carbon-intensive behaviors** more strongly affects the perceived size of carbon footprints than the amount of **high impact** carbon-intensive behaviors

```{r}
tab_model(model.perceptions.long.impact)

```

### Effect of high versus low impact behaviors  2
```{r}
tab_model(model.perceptions.long.impact2)

```

### Effect of high versus low impact behaviors Plot
```{r, message=FALSE, echo=FALSE}
p1 <- plot_model(model.perceptions.long.impact, type="emm" , terms=c("high.impact")) + ylim(1,10)
p2 <- plot_model(model.perceptions.long.impact, type="emm" , terms=c("low.impact")) + ylim(1,10)
p1 + p2
```

### Plot2
=> For high impact behaviors: if two or three (out of three) high impact behaviors are carbon intensive, this is associated with higher carbon footprint perceptions than when none of the high impact behaviors are carbon intensive   
=> For low impact behaviors: For increasing amount of low impact behaviors that are carbon intensive the perception of the size of carbon footprint increases (and most so when all 3 low impact behaviors are the more carbon intensive one)  
=> The number of low impact bheaviors that are carbon intensive seems to drive the the perception of the size of carbon footprint more than the number of high impact behaviors that are carbon intensive.  

```{r, message=FALSE, echo=FALSE}
plot_model(model.perceptions.long.impact2, terms=c("high.impact [1,2,all]", "low.impact [1,2,all]" ), show.values =TRUE, vline.color = "black")

```


```{r, include=FALSE}
model.perceptions.long.domain <- lmer(rating ~  high.impact +low.impact + food + transport +
                                   age + gender + income + education +

                            (1|participant.label) + (1|vignette),
                          data=data.perceptions.total.long1)
tab_model(model.perceptions.long.domain)

```

### Effect of different behaviors
```{r}
# order of impact in the choice task behaviors : vacation, diet, household, regional, commute, recylcing
model.perceptions1 <- lmer(rating ~ recycling + commute + regional + electricity +diet + flying +   
                             age + gender + income + education +
                            (1|participant.label) + (1|vignette),
                          data=data.perceptions.total)
tab_model(model.perceptions1)

#data.perceptions.total.excl
```
### Plot Effect of different behaviors
=> **Flying** accurately receives the highest impact weight, which is followed by **recyling** (actually least impactful #6), **diet** (#2), **regionality** (#4), **electricity supply** (#3) and **commuting** (#5)

```{r}

plot_model(model.perceptions1, show.values =TRUE, vline.color = "black")


```


## H1b Compensatory Beliefs 
### {.tabset}
*We expect that perceptions of the size of carbon footprints are influenced by interactions between behaviors. Specifically, we will investigate the interactions between: diet and regionality, diet and electricity supply, diet and flying, flying and commuting*

#### Overview
```{r comp}
#diet and regionality, diet and electricity supply, diet and flying, flying and commuting
model.perceptions.comp <- lmer(rating ~ diet*flying + diet*electricity + diet*regional + commute  + recycling +
                            age + gender + education +
                            (1|participant.label),
                          data=data.perceptions.total)

tab_model(model.perceptions.comp)

model.perceptions.comp.excl <- lmer(rating ~ diet*flying + diet*electricity + diet*regional + commute  + recycling +
                                   age + gender + education +
                                   (1|participant.label),
                               data=data.perceptions.total.excl)

tab_model(model.perceptions.comp.excl)
```

#### Diet and flying
```{r comp1}
#diet and regionality, diet and electricity supply, diet and flying, flying and commuting
model.perceptions.comp1 <- lmer(rating ~ diet*flying+electricity +regional + commute  + recycling +
                            age + gender + education +
                            (1|participant.label),
                          data=data.perceptions.total)

tab_model(model.perceptions.comp1)

```

#### Plot  Diet and flying
```{r}
plot_model(model.perceptions.comp1, type="pred", terms=c("diet", "flying"))

```

### For other interactions no evidence of compensatory beliefs {.tabset}

#### Diet and regional
```{r comp3}
model.perceptions.comp3 <- lmer(rating ~ diet + flying + electricity + diet*regional  + commute  + recycling +
                            age + gender + education +
                            (1|participant.label),
                          data=data.perceptions.total)

tab_model(model.perceptions.comp3)
plot_model(model.perceptions.comp3, type="pred", terms=c("diet", "regional"))

```

#### diet and electricity supply
```{r comp2}

model.perceptions.comp2 <- lmer(rating ~ diet + flying + diet*electricity +regional  + commute  + recycling +
                            age + gender + income + education +
                            (1|participant.label),
                          data=data.perceptions.total)

tab_model(model.perceptions.comp2)
plot_model(model.perceptions.comp2, type="pred", terms=c("diet", "electricity"))

```


#### Flying and commute to work
```{r}


model.perceptions.comp4 <- lmer(rating ~ diet + flying + electricity + regional + flying*commute  + recycling +
                            age + gender + education +
                            (1|participant.label),
                          data=data.perceptions.total)

tab_model(model.perceptions.comp4)
plot_model(model.perceptions.comp4, type="pred", terms=c("flying", "commute"))
```


## H2 accuracy  {.tabset}
*H2: We expect to find an association between the accuracy of carbon footprint estimations and individuals' climate change concern, political orientation, carbon footprints based on reported behavior, and policy support. Specifically, we expect that individuals with more accurate perceptions are more likely to have lower carbon footprints and report higher policy support.*

### Predicting Accuracy 
```{r}
model.accuracy2 <- lm(cor.tau ~ age + gender + education + income +
                       cc_concern.mean + conservative_liberal + total_co2,
                     data=data.accuracy.score.tau)
tab_model(model.accuracy2)
model.accuracy2.excl <- lm(cor.tau ~ age + gender + education + income +
                       cc_concern.mean + conservative_liberal + total_co2,
                     data=data.accuracy.score.tau.excl)
tab_model(model.accuracy2.excl)
#data.accuracy.score.tau.excl
```
### Distribution accuracy by cc concern
```{r}
ggplot(data.accuracy.score.tau, aes(x=cor.tau, fill=rel_cc_concern.mean.f, alpha=.3)) +
  geom_density() +
  theme_minimal() +
  scale_fill_manual(values=c(  "#a50000", "#ff8c00", "#F6BE00"))
```


### Policy support predicted by accuracy
```{r}
model.support.accuracy2 <- lm(policy.support.total ~ cor.tau+
                               age + gender + education + income +
                               cc_concern.mean ,
                             data=data.accuracy.score.tau)
tab_model(model.support.accuracy2)

model.support.accuracy.excl <- lm(policy.support.total ~ cor.tau+
                                  age + gender + education + income +
                                  cc_concern.mean ,
                              data=data.accuracy.score.tau.excl)
tab_model(model.support.accuracy.excl)

model.support.accuracy2.mod <- lm(policy.support.total ~ rel_cor.tau*rel_cc_concern.mean+
                               age + gender + education + income ,
                             data=data.accuracy.score.tau.excl)
#tab_model(model.support.accuracy2.mod)
# interaction not significant but both accuracy and cc concern remain sign

```

### Distribution policy support by accuracy

```{r}
ggplot(data.accuracy.score.tau, aes(x=policy.support.total, fill=rel_cor.tau.f, alpha=.3)) +
  geom_density() +
  theme_minimal() +
  scale_fill_manual(values=c(  "#a50000", "#ff8c00", "#F6BE00"))

```


### Carbon footprint predicted by accuracy 
```{r}

model.behavior.accuracy2 <- lm(total_co2 ~ cor.tau + cc_concern.mean+ conservative_liberal +
                                age + gender + education + income ,
                              data=data.accuracy.score.tau)
tab_model(model.behavior.accuracy2)

model.behavior.accuracy2.excl <- lm(total_co2 ~ cor.tau + cc_concern.mean+ conservative_liberal +
                                   age + gender + education + income ,
                               data=data.accuracy.score.tau.excl)
tab_model(model.behavior.accuracy2.excl)
# no sign interaction
model.behavior.accuracy2.mod <- lm(total_co2 ~ rel_cor.tau*rel_cc_concern.mean+ conservative_liberal +
                                   age + gender + education + income ,
                               data=data.accuracy.score.tau.excl)
#tab_model(model.behavior.accuracy2.mod)

```
### Distribution carbon footprint by accuracy

```{r}
ggplot(data.accuracy.score.tau, aes(x=total_co2, fill=rel_cc_concern.mean.f, alpha=.3)) +
  geom_density() +
  theme_minimal() +
  scale_fill_manual(values=c(  "#a50000", "#ff8c00", "#F6BE00"))


```

## Per behavior {.tabset}
```{r}
# alpha/6 is 0.008333333
## for footprint.flying not significant (p ~0.86)
## for footprint.diet not significant when controlling for multiple tests (p  0.028)
## for footprint.travel.car not significant (p  0.07)
## for footprint.electricity not significant (p  0.459)

#data.accuracy.score.tau1 <- data.accuracy.score.tau %>% rename(policy = policy.car)
#data.accuracy.score.tau2 <- data.accuracy.score.tau %>% rename(policy = policy.flying)
#data.accuracy.score.tau3 <- data.accuracy.score.tau %>% rename(policy = policy.meat)
#data.accuracy.score.tau4 <- data.accuracy.score.tau %>% rename(policy = policy.RE)
#data.accuracy.score.tau5 <- data.accuracy.score.tau %>% rename(policy = policy.regional_food)

model.behavior.accuracy1.car <- lm(footprint.travel.car ~   cc_concern.mean+ conservative_liberal + cor.tau + # policy+
                                age + gender + education + income ,
                              data=data.accuracy.score.tau.excl)
model.behavior.accuracy1.fly <- lm(footprint.flying ~   cc_concern.mean+ conservative_liberal  + cor.tau + # policy+
                                age + gender + education + income ,
                              data=data.accuracy.score.tau.excl)

model.behavior.accuracy1.diet <- lm(footprint.diet ~    cc_concern.mean+  conservative_liberal  + cor.tau +  # policy+
                                age + gender + education + income ,
                              data=data.accuracy.score.tau.excl)

model.behavior.accuracy1.elec <- lm(footprint.electricity ~  +cc_concern.mean+ conservative_liberal  + cor.tau +  # policy+
                                age + gender + education + income ,
                              data=data.accuracy.score.tau.excl)

model.behavior.accuracy1.reg <- lm(footprint.regional ~  cc_concern.mean+ conservative_liberal  + cor.tau +  # policy+
                                age + gender + education + income ,
                              data=data.accuracy.score.tau.excl)

```

**Overall plot**
```{r     message=FALSE, fig.width=25, fig.height=16}
plot_models( model.behavior.accuracy1.car, model.behavior.accuracy1.fly, model.behavior.accuracy1.diet,model.behavior.accuracy1.elec , model.behavior.accuracy1.reg, dot.size = 5, line.size=1.2, show.p = TRUE, p.shape=TRUE, p.threshold = c(0.05, 0.05/6), rm.terms=c("income [18.000£ to 23.000£, 23.001£ to 30.500£, 0.501£ to 45.000£]","education [Further education, Higher education (Bachelor, Master, PhD)]") ) +
  scale_color_viridis_d() + theme_minimal()+
   theme(plot.caption = element_text(hjust = 0),
          plot.title.position = "plot",
          plot.caption.position =  "plot",
          plot.title = element_text(size = 25, face = "bold",family = 'Arial', color="black"),
          axis.title  = element_text(size = 25, family = 'Arial', color="black"),
          axis.text = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.y = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.x = element_text(size = 23, family = 'Arial', color="black"),
          legend.title = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          strip.text = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          legend.text = element_text(size = 22,family = 'Arial', color="black")) 
```


### car
```{r}
tab_model(model.behavior.accuracy1.car)

```

### flying
```{r}
tab_model(model.behavior.accuracy1.fly)

```

### diet
```{r}
tab_model(model.behavior.accuracy1.diet)

```

### electricity
```{r}
tab_model(model.behavior.accuracy1.elec)

```

### regional
```{r}
tab_model(model.behavior.accuracy1.reg)

```

## H3 Impact perceptions (=Regression weights) predicted by reported behavior?

### Correlations between regression weights
```{r}

corr.regr.weights <- data.regression.weights %>% select(ends_with("weight"))
coef.reg.weights <- rcorr(as.matrix(corr.regr.weights))

corrplot(coef.reg.weights$r, type="upper", order="hclust", 
         p.mat = NULL, sig.level = 0.05, insig = "blank")

```

*We expect that the perceived impact of behaviors on the size of carbon footprints is influenced by self-reported climate relevant behavior. Specifically, we expect that individuals exhibit motivated reasoning such that the more a person engages in a given climate-unfriendly behavior, the lower they estimate the behavior to have an impact on the size of carbon footprints.*

## Behaviors as factors {.tabset}

### Flying
```{r}


#data.regression.weights$footprint.flying_fact <- factor(data.regression.weights$footprint.flying_fact, levels=c("0" , "0.36", "0.9", "2.07",  "3.59",  "6.74", "13.48" ), labels=c("no flying", "under 7 hours", "under 7 hours","more than 7 hours", "more than 7 hours", "more than 7 hours",  "more than 7 hours") )
model.weight.flying.fact <- lm(flying.weight ~ footprint.flying_fact    + 
                            gender + age + income + education + cc_concern.mean,
                          data=data.regression.weights)
tab_model(model.weight.flying.fact)

model.weight.flying.fact.excl <- lm(flying.weight ~ footprint.flying_fact    + 
                            gender + age + income + education + cc_concern.mean,
                          data=data.regression.weights.excl)
#tab_model(model.weight.flying.fact.excl)
# p-value now 0.005
```

### Diet
```{r}

# data.regression.weights$footprint.diet_fact.2 <- factor(data.regression.weights$footprint.diet_fact, levels=c("vegan", "vegetarian", "no red meat", "pescetarian", "meat-based", "no pork") , labels=c("reduction of meat", "reduction of meat", "reduction of meat", "reduction of meat", "meat-based", "meat-based"))

model.weight.diet.fact <- lm(diet.weight ~  footprint.diet_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights)
tab_model(model.weight.diet.fact)

model.weight.diet.fact.excl <- lm(diet.weight ~  footprint.diet_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights.excl)
#tab_model(model.weight.diet.fact.excl)
# no difference really
```

### Electricity
```{r}
model.weight.elec.fact <- lm(electricity.weight ~  footprint.electricity_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights)
tab_model(model.weight.elec.fact)
```

### Regional
```{r}
model.weight.reg.fact <- lm(regional.weight ~  footprint.regional_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights)
tab_model(model.weight.reg.fact)
```

### Commute
```{r}
model.weight.commute.fact <- lm(commute.weight ~  footprint.travel.car_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights)
tab_model(model.weight.commute.fact)
```
### Recycling
```{r}
model.weight.recycle.fact <- lm(recycling.weight ~  footprint.recycling_fact +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights)
tab_model(model.weight.recycle.fact)
```


##  Behaviors as numerical values {.tabset}
Info: this excludes participants with negative regression weights because that makes no sense and should not be possible.   
  
  
```{r}

#Interaction with rel.cc.concern not helpful

## Using impact weights per high versus low behavior => so regression weights for low versus high also no effect, but here the variance also much smaller than for the individual behaviors

data.regression.weights.f <- data.regression.weights.excl %>% rename(footprint=footprint.flying)
model.weight.flying <- lm(flying.weight ~ footprint +
                            gender + age + income + education + cc_concern.mean,
                          data=data.regression.weights.f)

data.regression.weights.d <- data.regression.weights.excl %>% rename(footprint=footprint.diet)
model.weight.diet<- lm(diet.weight ~  footprint + 
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights.d)

data.regression.weights.e <- data.regression.weights.excl %>% rename(footprint=footprint.electricity)
model.weight.elec<- lm(electricity.weight ~  footprint +
                         gender + age + income + education + cc_concern.mean,
                       data=data.regression.weights.e)

data.regression.weights.t <- data.regression.weights.excl %>% rename(footprint=footprint.travel.car)
model.weight.transport<- lm(commute.weight ~ footprint +
                              gender + age + income + education + cc_concern.mean,
                            data=data.regression.weights.t)

data.regression.weights.reg <- data.regression.weights.excl %>% rename(footprint=footprint.regional)
model.weight.regional<- lm(regional.weight ~footprint +
                       gender + age + income + education + cc_concern.mean,
                     data=data.regression.weights.reg)

data.regression.weights.rec <- data.regression.weights.excl %>% rename(footprint=footprint.recycling)
model.weight.recycle <- lm(recycling.weight ~footprint +
                       gender + age + income + education + cc_concern.mean,
                     data=data.regression.weights.rec)
```

**Overview plot**
```{r plot.weights,    message=FALSE, fig.width=25, fig.height=16}


plot_models(model.weight.flying, model.weight.diet, model.weight.elec, model.weight.transport,  model.weight.regional ,dot.size = 5, line.size=1.2, show.p = TRUE, p.shape=TRUE, p.threshold = c(0.05, 0.05/6) ) +
  scale_color_viridis_d() + theme_minimal()+
   theme(plot.caption = element_text(hjust = 0),
          plot.title.position = "plot",
          plot.caption.position =  "plot",
          plot.title = element_text(size = 25, face = "bold",family = 'Arial', color="black"),
          axis.title  = element_text(size = 25, family = 'Arial', color="black"),
          axis.text = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.y = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.x = element_text(size = 23, family = 'Arial', color="black"),
          legend.title = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          strip.text = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          legend.text = element_text(size = 22,family = 'Arial', color="black")) 



```

### Flying
```{r}
tab_model(model.weight.flying)

```

### Diet
```{r}
tab_model(model.weight.diet)
```

### Electricity
```{r}

tab_model(model.weight.elec)
```


### Transport
```{r}
tab_model(model.weight.transport)

```

### Regional   

    
```{r}
tab_model(model.weight.regional)
```

### Recycling
```{r}
tab_model(model.weight.recycle)
```



## H4 Impact perceptions (=regression weights) predicting policy  {.tabset}
Again excluding participants with negative regression weights.  
  
  
*We expect that climate policy support for specific consumer behaviors is influenced by the perceived impact of those behaviors on the size of carbon footprints. Specifically, we expect that individuals with higher (versus lower) impact perceptions of a behavior are more supportive of policies targeting that behavior. *
```{r}
data.regression.weights1 <-  data.regression.weights.excl %>% rename(weight=flying.weight)
model.policy.flying <- lm(policy.flying.tax ~  weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                           data=data.regression.weights1)

data.regression.weights2 <- data.regression.weights.excl %>% rename(weight=commute.weight)
model.policy.car<- lm(policy.car.tax ~  weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                          data=data.regression.weights2)

data.regression.weights3 <- data.regression.weights.excl %>% rename(weight=diet.weight)
model.policy.meat<- lm(policy.meat.tax ~ weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights3)

data.regression.weights4 <- data.regression.weights.excl %>% rename(weight=electricity.weight)
model.policy.elec<- lm(policy.RE.tax ~  weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights4)

data.regression.weights5 <- data.regression.weights.excl %>% rename(weight=regional.weight)
model.policy.regional<- lm(policy.regional_food.tax ~ weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights5)

data.regression.weights6 <- data.regression.weights.excl %>% rename(weight=recycling.weight)
model.policy.recycle<- lm(policy.recycle.tax ~ weight +
                            cc_concern.mean+ conservative_liberal +
                            gender + age + income + education ,
                          data=data.regression.weights6)
```

**Overview plot**

Note: this is using the policy support for the tax version of the policy (when using the mean of the tax plus subsidy policy the results are slightly different: the meat.policy is not significant at all).  
  
  

```{r p1,    message=FALSE, fig.width=25, fig.height=16}
plot_models(model.policy.meat, model.policy.flying, model.policy.elec, model.policy.car,  model.policy.recycle, model.policy.regional ,dot.size = 5, line.size=1.2, show.p = TRUE, p.shape=TRUE, p.threshold = c(0.05, 0.05/6) )  +
  scale_color_viridis_d() +  theme_minimal()+
   theme(plot.caption = element_text(hjust = 0),
          plot.title.position = "plot",
          plot.caption.position =  "plot",
          plot.title = element_text(size = 25, face = "bold",family = 'Arial', color="black"),
          axis.title  = element_text(size = 25, family = 'Arial', color="black"),
          axis.text = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.y = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.x = element_text(size = 23, family = 'Arial', color="black"),
          legend.title = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          strip.text = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          legend.text = element_text(size = 22,family = 'Arial', color="black")) 

```

### Policy affecting air traffic

```{r}
tab_model(model.policy.flying)

```

### Policy affecting car use
```{r}
tab_model(model.policy.car)

```

### Diet
```{r}
tab_model(model.policy.meat)

```

### Policy electricity
```{r}
tab_model(model.policy.elec)
```

### Policy regional
```{r}
tab_model(model.policy.regional)
```

### Policy recycling
```{r}
tab_model(model.policy.recycle)
```

## H4 with cc concern as moderator
```{r}
model.policy.flying.mod <- lm(policy.flying.tax ~  weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                           data=data.regression.weights1)

model.policy.car.mod <- lm(policy.car.tax ~  weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                          data=data.regression.weights2)

model.policy.meat.mod <- lm(policy.meat.tax ~ weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights3)

model.policy.elec.mod <- lm(policy.RE.tax ~  weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights4)

model.policy.regional.mod <- lm(policy.regional_food.tax ~ weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                      data=data.regression.weights5)

model.policy.recycle.mod <- lm(policy.recycle.tax ~ weight*rel.cc.concern +
                            conservative_liberal +
                            gender + age + income + education ,
                          data=data.regression.weights6)
```

```{r , message=FALSE, fig.width=25, fig.height=16}

plot_models(model.policy.meat.mod, model.policy.flying.mod, model.policy.elec.mod, model.policy.car.mod,  model.policy.recycle.mod, model.policy.regional.mod ,dot.size = 5, line.size=1.2, show.p = TRUE, p.shape=TRUE, p.threshold = c(0.05, 0.05/6) )  +
  scale_color_viridis_d() +  theme_minimal()+
   theme(plot.caption = element_text(hjust = 0),
          plot.title.position = "plot",
          plot.caption.position =  "plot",
          plot.title = element_text(size = 25, face = "bold",family = 'Arial', color="black"),
          axis.title  = element_text(size = 25, family = 'Arial', color="black"),
          axis.text = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.y = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.x = element_text(size = 23, family = 'Arial', color="black"),
          legend.title = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          strip.text = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          legend.text = element_text(size = 22,family = 'Arial', color="black")) 



```

```{r}
plot_model(model.policy.meat.mod, type="emm", terms=c("weight", "rel.cc.concern"))
plot_model(model.policy.car.mod, type="emm", terms=c("weight", "rel.cc.concern"))
```


## regression weights and behavior predicting policy {.tabset}
```{r}
data.regression.weights1.1 <- data.regression.weights.excl %>% rename(weight=flying.weight,
                                                                 behavior = footprint.flying)
model.policy.flying.2 <- lm(policy.flying ~weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                           data=data.regression.weights1.1)

data.regression.weights2.1 <- data.regression.weights.excl %>% rename(weight=commute.weight,
                                                                   behavior = footprint.travel.car)
model.policy.car.2 <- lm(policy.car ~ weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                          data=data.regression.weights2.1)
data.regression.weights3.1 <- data.regression.weights.excl %>% rename(weight=diet.weight,
                                                                 behavior = footprint.diet)
model.policy.meat.2 <- lm(policy.meat ~ weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                      data=data.regression.weights3.1)

data.regression.weights4.1 <- data.regression.weights.excl %>% rename(weight=electricity.weight,
                                                                 behavior = footprint.electricity)
model.policy.elec.2 <- lm(policy.RE ~ weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                      data=data.regression.weights4.1)
data.regression.weights5.1 <- data.regression.weights.excl %>% rename(weight=regional.weight,
                                                                 behavior= footprint.regional)
model.policy.regional.2 <- lm(policy.regional_food ~ weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                      data=data.regression.weights5.1)
data.regression.weights6.1 <- data.regression.weights.excl %>% rename(weight=recycling.weight,
                                                               behavior = footprint.recycling)
model.policy.recycle.2 <- lm(policy.recycle ~ weight   + behavior +
                        gender + age + income + education  + 
                          cc_concern.mean + conservative_liberal,
                      data=data.regression.weights6.1)

```

**Overview plot**  


```{r p2,    message=FALSE, fig.width=20, fig.height=16}
plot_models(model.policy.meat.2, model.policy.flying.2, model.policy.elec.2, model.policy.car.2 ,dot.size = 5, line.size=1.2, show.p = TRUE, p.shape=TRUE, p.threshold = c(0.05, 0.01) )  +
  scale_color_viridis_d() + theme_minimal()+
   theme(plot.caption = element_text(hjust = 0),
          plot.title.position = "plot",
          plot.caption.position =  "plot",
          plot.title = element_text(size = 25, face = "bold",family = 'Arial', color="black"),
          axis.title  = element_text(size = 25, family = 'Arial', color="black"),
          axis.text = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.y = element_text(size = 23, family = 'Arial', color="black"),
          axis.text.x = element_text(size = 23, family = 'Arial', color="black"),
          legend.title = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          strip.text = element_text(size = 22, face="plain",family = 'Arial', color="black"),
          legend.text = element_text(size = 22,family = 'Arial', color="black")) 



```

### Policy affecting air traffic

```{r}
### policy
tab_model(model.policy.flying.2)
```

### Policy affecting car use
```{r}
tab_model(model.policy.car.2)

```

### Diet
```{r}
tab_model(model.policy.meat.2)

```

### Policy electricity
```{r}
tab_model(model.policy.elec.2)
```


### Policy regional
```{r}
tab_model(model.policy.regional.2)
```

### Policy recycling
```{r}
tab_model(model.policy.recycle.2)
```




